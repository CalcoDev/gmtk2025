[gd_scene load_steps=14 format=3 uid="uid://lmelvc3xpj08"]

[ext_resource type="Shader" uid="uid://c2gqactx5rbcc" path="res://shaders/starry_background.gdshader" id="1_27dq3"]
[ext_resource type="Script" uid="uid://bndtq0kbw64si" path="res://scenes/enemy_spawner.gd" id="1_cd025"]
[ext_resource type="Texture2D" uid="uid://dylckaef42rk5" path="res://assets/court.png" id="1_mvhas"]
[ext_resource type="PackedScene" uid="uid://vqcl33id82v" path="res://scenes/player/player.tscn" id="2_27dq3"]
[ext_resource type="Script" uid="uid://cxcn0oyf7lev0" path="res://scripts/kcamera.gd" id="3_1126i"]
[ext_resource type="Script" uid="uid://dk6efu76hro77" path="res://scripts/sparks/sparks_renderer.gd" id="4_cd025"]
[ext_resource type="PackedScene" uid="uid://cmjl4rp0fiqtq" path="res://scenes/enemy/enemy.tscn" id="6_1126i"]
[ext_resource type="PackedScene" uid="uid://bh8x7m21c4noe" path="res://scenes/ball/ball.tscn" id="7_cd025"]
[ext_resource type="FontFile" uid="uid://cutyo7w3ckfal" path="res://resources/fonts/Spectral-Bold.ttf" id="8_uyhvn"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_1126i"]
shader = ExtResource("1_27dq3")
shader_parameter/u_speed = 0.2

[sub_resource type="Animation" id="Animation_1bvp3"]
resource_name = "wave_announcement"
length = 2.0
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Wave:position")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.866667, 1.13333, 2),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 0,
"values": [Vector2(213, -28), Vector2(213, 123), Vector2(213, 123), Vector2(213, 267)]
}

[sub_resource type="Animation" id="Animation_lquwl"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Wave:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(213, -28)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_7mycd"]
_data = {
&"RESET": SubResource("Animation_lquwl"),
&"wave_announcement": SubResource("Animation_1bvp3")
}

[node name="GameplayScene" type="Node2D"]
script = ExtResource("1_cd025")

[node name="Background" type="ColorRect" parent="."]
visible = false
z_index = -10
offset_left = -571.0
offset_top = -351.0
offset_right = 577.0
offset_bottom = 411.0
color = Color(0.054902, 0.054902, 0.054902, 1)

[node name="StarryBackground" type="ColorRect" parent="."]
z_index = -10
material = SubResource("ShaderMaterial_1126i")
offset_left = -575.0
offset_top = -335.0
offset_right = 515.0
offset_bottom = 322.0
color = Color(0.054902, 0.054902, 0.054902, 1)

[node name="Court" type="Sprite2D" parent="."]
z_index = -10
scale = Vector2(2.59852, 2.59852)
texture = ExtResource("1_mvhas")

[node name="Bullets" type="Node2D" parent="." groups=["bullets"]]

[node name="Player" parent="." instance=ExtResource("2_27dq3")]
position = Vector2(-170, -18)
dash_speed = 50.0

[node name="KCamera" type="Camera2D" parent="Player"]
script = ExtResource("3_1126i")
metadata/_custom_type_script = "uid://cxcn0oyf7lev0"

[node name="SparksRenderer" type="Node2D" parent="."]
script = ExtResource("4_cd025")
metadata/_custom_type_script = "uid://dk6efu76hro77"

[node name="CourtCollision" type="StaticBody2D" parent="."]
collision_layer = 32768
collision_mask = 0

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="CourtCollision"]
build_mode = 1
polygon = PackedVector2Array(-260, -161, -260, 161, 260, 161, 260, -161)

[node name="LevelBounds" type="StaticBody2D" parent="."]
collision_mask = 0

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="LevelBounds"]
scale = Vector2(1.77948, 1.7238)
build_mode = 1
polygon = PackedVector2Array(-260, -161, -260, 161, 260, 161, 260, -161)

[node name="Ball" parent="." instance=ExtResource("7_cd025")]
position = Vector2(95, 57)
scale = Vector2(1.63403, 1.63403)
friction = 1.0
bounce_damping = 0.4
max_spin_force = 600.0

[node name="Marker2D" type="Marker2D" parent="."]
position = Vector2(254, 156)

[node name="spawn_enemies_here" type="Node2D" parent="." groups=["spawn_enemies_here"]]

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="AnimationPlayer" type="AnimationPlayer" parent="CanvasLayer"]
libraries = {
&"": SubResource("AnimationLibrary_7mycd")
}

[node name="Score" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 0
offset_left = 213.0
offset_top = 20.0
offset_right = 213.0
offset_bottom = 20.0

[node name="Score" type="RichTextLabel" parent="CanvasLayer/Score"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -56.0
offset_top = -20.0
offset_right = 56.0
offset_bottom = 20.0
grow_horizontal = 2
grow_vertical = 2
theme_override_fonts/normal_font = ExtResource("8_uyhvn")
text = "Score: 0"
horizontal_alignment = 1
vertical_alignment = 1

[node name="Wave" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 0
offset_left = 213.0
offset_top = -28.0
offset_right = 213.0
offset_bottom = -28.0

[node name="Score" type="RichTextLabel" parent="CanvasLayer/Wave"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -56.0
offset_top = -20.0
offset_right = 56.0
offset_bottom = 20.0
grow_horizontal = 2
grow_vertical = 2
theme_override_fonts/normal_font = ExtResource("8_uyhvn")
text = "Wave 10"
horizontal_alignment = 1
vertical_alignment = 1

[node name="EnemySpawner" type="Node2D" parent="CanvasLayer" node_paths=PackedStringArray("score_label", "wave_announcement_label", "animation_player")]
script = ExtResource("1_cd025")
score_label = NodePath("../Score/Score")
wave_announcement_label = NodePath("../Wave/Score")
animation_player = NodePath("../AnimationPlayer")
enemy_scene = ExtResource("6_1126i")
enemies_per_wave_increase = 3
wave_announcement_duration = 2.0
metadata/_custom_type_script = "uid://bndtq0kbw64si"
